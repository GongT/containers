[global]
server role = standalone server
logging  = syslog
log level = 1 auth_audit:5 vfs:2
workgroup = WORKGROUP
server string = shabao's SAMBA share server
min protocol = SMB2
security = user

kernel oplocks = yes

load printers = no
name resolve order = bcast lmhosts wins host
local master = yes
wins support = no
preferred master = yes

map acl inherit = yes 
map archive = no
map hidden = no
map read only = no
map system = no
store dos attributes = yes
inherit permissions = yes
nt acl support = yes
acl allow execute always = yes

full_audit:failure = all
# full_audit:success =
full_audit:prefix = %S|%u|%U

# template shell = /bin/bash
# template homedir = /home/%U
vfs objects = full_audit btrfs recycle

passdb backend = tdbsam

valid users = +smbusers media_rw
; admin users = +smbusers media_rw
write list = +smbusers media_rw

idmap config * : backend = tdb
idmap config * : range = 1000-6999
username map = /etc/samba/username.map.generate
ntlm auth = yes

recycle:repository = .$samba/recycle/%U
recycle:touch = yes
recycle:keeptree = yes
recycle:versions = no
recycle:excludedir = .$samba
